<!doctype html>
<html lang="en" style="overflow: hidden; height: 100%;">

  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>drunner</title>
    <style>
      html,
      body {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
        position: fixed;
        top: 0;
        left: 0;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }

      #app-loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #1a202c;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        gap: 1.5rem;
      }

      #app-loader .spinner {
        width: 5vw;
        height: 5vw;
        min-width: 40px;
        min-height: 40px;
        max-width: 80px;
        max-height: 80px;
        border: 0.3vw solid #2d3748;
        border-top-color: #fb923c;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }

      #app-loader .text {
        color: #fb923c;
        font-size: clamp(1rem, 2vw, 1.5rem);
        font-weight: bold;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        font-family: system-ui, -apple-system, sans-serif;
      }

      #error-display {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #1a202c;
        color: white;
        padding: 20px;
        overflow: auto;
        z-index: 10000;
        display: none;
        font-family: monospace;
      }

      #error-display.show {
        display: block;
      }

      #error-display h1 {
        color: #fc8181;
        margin-top: 0;
      }

      #error-display pre {
        background: #2d3748;
        padding: 15px;
        border-radius: 5px;
        overflow: auto;
        white-space: pre-wrap;
        word-wrap: break-word;
        font-size: 12px;
        border: 2px solid #fc8181;
      }

      #error-display button {
        background: #3182ce;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        margin-top: 10px;
      }
    </style>
    <script>
      // Fix mobile viewport height
      function setVH() {
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', vh + 'px');
      }
      setVH();
      window.addEventListener('resize', setVH);
      window.addEventListener('orientationchange', setVH);

      // Early error catcher for mobile debugging
      window.earlyErrors = [];

      function showError(msg, source, lineno, colno, error) {
        var errorDisplay = document.getElementById('error-display');
        var errorList = document.getElementById('error-list');

        var errorDiv = document.createElement('div');
        errorDiv.style.marginBottom = '20px';
        errorDiv.innerHTML = '<h2>Error Details:</h2>' +
          '<pre><strong>Message:</strong> ' + (msg || 'Unknown error') + '\n' +
          '<strong>Source:</strong> ' + (source || 'Unknown') + '\n' +
          '<strong>Line:</strong> ' + (lineno || '?') + ', <strong>Col:</strong> ' + (colno || '?') + '\n\n' +
          '<strong>Stack:</strong>\n' + (error && error.stack ? error.stack : 'No stack trace') + '</pre>';

        errorList.appendChild(errorDiv);
        errorDisplay.className = 'show';

        // Hide loader
        var loader = document.getElementById('app-loader');
        if (loader) loader.style.display = 'none';

        return true;
      }

      window.addEventListener('error', function (event) {
        console.error('Global error event:', event.message);
        console.error('  Filename:', event.filename);
        console.error('  Line:Col:', event.lineno + ':' + event.colno);
        console.error('  Error object:', event.error);
        
        // Check if this is a module loading error
        if (event.filename && event.filename.includes('main.tsx')) {
          console.error('>>> ERROR IN MAIN.TSX MODULE! <<<');
        }
        
        showError(event.message, event.filename, event.lineno, event.colno, event.error);
      });

      window.addEventListener('unhandledrejection', function (event) {
        console.error('Unhandled promise rejection:', event.reason);
        showError(
          'Unhandled Promise Rejection: ' + (event.reason ? event.reason.message || event.reason : 'Unknown'),
          event.reason && event.reason.fileName,
          event.reason && event.reason.lineNumber,
          event.reason && event.reason.columnNumber,
          event.reason
        );
      });
    </script>
  </head>
  <body>
    <div id="error-display">
      <h1>⚠️ Application Error</h1>
      <p>The application failed to load. See error details below:</p>
      <div id="error-list"></div>
      <button onclick="window.location.reload()">Reload Page</button>
    </div>
    <div id="app-loader">
      <div class="spinner"></div>
      <div class="text">Loading Dungeon Runner...</div>
    </div>
    <div id="root" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden;"></div>
    <script type="module" src="/src/main.tsx" onerror="console.error('Script tag onerror fired - module failed to load')"></script>
  </body>

</html>